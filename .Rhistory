library(tidyverse)
library(haven)
library(ggplot2)
library(dplyr)
library(plyr)
library(naniar)
library(reshape2)
# BP
bp$datediff <- as.numeric(bp$MEASURE_DATE - bp$index_date)
bp1 <- bp[which(bp$datediff %in% -365:0),]
bp1 <- ddply(bp1, .(CVD_studyid), function(d){
d <- d[which(d$datediff==max(d$datediff)),]
d
})
## clean up bp
bp1$hypertension <- factor(bp1$hypertension,
labels = c('Normal','Elevated','Stage 1','Stage 2','Undefined'))
## aggregate multiple values within same day
systol <- aggregate(x = bp1$SYSTOLIC,
by = list(bp1$CVD_studyid,bp1$index_date,
bp1$MEASURE_DATE,bp1$datediff),
mean, na.rm=T)
diastol <- aggregate(x = bp1$DIASTOLIC,
by = list(bp1$CVD_studyid,bp1$index_date,
bp1$MEASURE_DATE,bp1$datediff),
mean, na.rm=T)
bp1 <- merge(systol, diastol, by=c("Group.1","Group.2", "Group.3" ,"Group.4"))
names(bp1) <- c('cvd_studyid','index_date','bp_measure_date','bp_datediff','systolic','diastolic')
# Labs
labs$result <- as.numeric(labs$RESULT_C)
labs$datediff <- as.numeric(labs$test_dt - labs$index_date)
labs1 <- labs[which(labs$datediff %in% -365:0),]
labs2 <- ddply(labs1, .(CVD_studyid,TEST_TYPE), function(d){
d <- d[which(d$datediff==max(d$datediff)),]
d
})
labs2 <- dcast(data=labs2,CVD_studyid+index_date+control_group+caco~TEST_TYPE,
value.var = 'result', mean, na.rm=T)
# Smoking
smok$datediff <- as.numeric(smok$CONTACT_DATE - smok$index_date)
smok1 <- smok[which(smok$datediff %in% -365:0),]
smok1 <- ddply(smok1, .(CVD_studyid), function(d){
d <- d[order(d$datediff, decreasing = T),]
d[1,]
})
str(smok1)
datalist <- list(all,
bmi1[,c("cvd_studyid","bmi_measure_date", "bmi_datediff", "bmi")],
bp1[,c("cvd_studyid","bp_measure_date", "bp_datediff","systolic","diastolic")],
labs2[,c("CVD_studyid","GLU_F","GTT75_PRE","HDL","HGBA1C","LDL_CLC_NS","TOT_CHOLES","TRIGL_NS" )],
diab[,c(1,4:10)],lipid[,2:4],
smok1[,c(2,5:8)],menop[,c(1,3)],parity[,c(1,5,6)],
census[,c(2,5:48)],
cvd2)
datalist <- lapply(datalist,function(x){
names(x) <- tolower(names(x))
x
})
a1 <- Reduce(function(...) merge(...,by='cvd_studyid', all.x=T), datalist)
a1[,124:133] <- lapply(a1[,124:133], function(x) {
x[is.na(x)] <- 0
x
})
################################################################################
# Create some more variables...
# recode categorical variables
# age groups
a1$agegrp <- cut(a1$dxage, c(0, 40, 50, 60, 70, 80, 101), right=F,
labels = c('<40 yo','40-49','50-59','60-69','70-79','80+ yo'))
# race
a1$raceethn1 <- factor(a1$raceethn1,
labels=c("WHITE","BLACK","ASIAN","HISPANIC","PI","AI-AN"))
# postive nodes
a1$nodal <- factor(a1$nodal, labels = c('Positive','Negative'))
# tumor markers
a1[,c('er','pr','her2')] <- lapply(a1[,c('er','pr','her2')], function(x)
factor(x, levels = c(0,1,2,3,8,9),
labels = c('Not done','Positive','Negative',
'Borderline','Ordered, N/A',
'Unknown')))
# erpr status
a1$erpr <- factor(a1$erpr, labels = c('ER+/PR+','ER+/PR-','ER-/PR+','ER-/PR-',
'UNKNOWN'))
# more tumor markers and treatment received
a1[,c('tri_neg','chemo_yn','rad_yn','horm_yn')] <-
lapply(a1[,c('tri_neg','chemo_yn','rad_yn','horm_yn')], function(x)
factor(x, levels = c(0,1,9),
labels = c('No','Yes','Other')))
# AJCC stage
a1$ajcc_stage <- factor(a1$ajcc_stage,
labels = c('Stage I','Stage II', 'Stage III','Stage IV'))
# convert dxdate to date
a1$dxdate <- as.Date(a1$dxdate, origin = '1970-01-01')
# enrolled in Pathways
a1$enrolled <- factor(a1$enrolled, levels = c(0,1), labels=c('No','Yes'))
# create index year
a1$index_yr <- format(a1$index_date,"%Y")
a1$index_yr[a1$index_yr %in% c('2005','2006','2007')] <- '2005-2007'
a1$index_yr[a1$index_yr %in% c('2008','2009','2010')] <- '2008-2010'
a1$index_yr[a1$index_yr %in% c('2011','2012','2013')] <- '2011-2013'
a1$index_yr <- factor(a1$index_yr)
# create enrollment length
a1$enr_len <- as.numeric((a1$enr_end - a1$enr_start)/30)
# BMI category
a1$bmicat <- cut(a1$bmi, c(0,18.5,25,30,35,Inf),right=F,
labels = c('Underweight','Normal','Overweight','Obese I','Obese II+'))
# smoking status
a1$smok <- factor(a1$tobacco_use, levels=c('N','Y','P','Q','U'),
labels = c('No','Current','Past','Quitted','Unknown'))
# menopausal status
a1$menop <- factor(a1$bl_meno_status)
a1$menop[is.na(a1$menop) & a1$dxage>51] <- '1'
a1$menop[is.na(a1$menop) & a1$dxage<=51] <- '0'
# gravidity
a1$gravid <- cut(as.numeric(a1$ob_gravidity), c(0,1,2,3,Inf),right=F,
labels = c('0','1','2','3+'))
a1$parity <- cut(as.numeric(a1$ob_parity), c(0,1,2,3,Inf),right=F,
labels = c('0','1','2','3+'))
# diabetes
a1[,c("inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg")] <- lapply(a1[,c("inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg")],
function(x){
x[is.na(x)] <- 2
x <- factor(x, levels=c(1,0,2),labels = c('Yes','No','Unknown'))
x
})
# dyslipidemia
a1$dyslipidemia[is.na(a1$dyslipidemia)] <- 0
a1$dyslipidemia <- factor(a1$dyslipidemia,levels=c(1,0),
labels = c('Yes','No/Unknown'))
# household income
a1$hhincome1 <- rowSums(a1[,c(96:104)], na.rm = T)
a1$hhincome2 <- rowSums(a1[,c(105:107)], na.rm = T)
a1$hhincome3 <- rowSums(a1[,c(108:111)], na.rm = T)
# education
a1$edu1 <- rowSums(a1[,c(70:72)], na.rm = T)
a1$edu2 <- rowSums(a1[,c(73:74)], na.rm = T)
a1$edu3 <- a1$education6
a1$edu4 <- rowSums(a1[,c(76:77)], na.rm = T)
a1$dyslipidemia.x[is.na(a1$dyslipidemia.x)] <- 0
a1$dyslipidemia.x <- factor(a1$dyslipidemia.x,levels=c(1,0),
labels = c('Yes','No/Unknown'))
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
tabel1 <- cbind(row.names(table1), table1)
tabel1
tab1 <- function(x){
if(class(a1[,x]) %in% c('numeric')){
n <- c(length(which(!is.na(a1[,x]))),
tapply(a1[,x], a1$group, function(x) length(which(!is.na(x)))))
m <- c(mean(a1[,x], na.rm=T),
tapply(a1[,x], a1$group,mean, na.rm=T))
sd <- c(sd(a1[,x], na.rm=T),
tapply(a1[,x], a1$group,sd, na.rm=T))
p <- t.test(a1[,x]~a1$group)$p.value
sum <- c(x,n[1],m[1],sd[1],'',n[2],m[2],sd[2],'',n[3],m[3],sd[3],'',p)
}
if(class(a1[,x]) %in% c('factor')){
n <- cbind(table(a1[,x]),table(a1[,x], a1$group))
pct <- cbind(prop.table(table(a1[,x])),
prop.table(table(a1[,x], a1$group),2))
p <- chisq.test(table(a1[,x], a1$group))$p.value
sum <- cbind(x,'',n[,1],pct[,1],'','',n[,2],pct[,2],'','',n[,3],pct[,3],'',p)
}
sum
}
tab1 <- function(x){
if(class(a1[,x]) %in% c('numeric')){
n <- c(length(which(!is.na(a1[,x]))),
tapply(a1[,x], a1$group, function(y) length(which(!is.na(y)))))
m <- c(mean(a1[,x], na.rm=T),
tapply(a1[,x], a1$group,mean, na.rm=T))
sd <- c(sd(a1[,x], na.rm=T),
tapply(a1[,x], a1$group,sd, na.rm=T))
p <- t.test(a1[,x]~a1$group)$p.value
sum <- c(x,n[1],m[1],sd[1],'',n[2],m[2],sd[2],'',n[3],m[3],sd[3],'',p)
}
if(class(a1[,x]) %in% c('factor')){
n <- cbind(table(a1[,x]),table(a1[,x], a1$group))
pct <- cbind(prop.table(table(a1[,x])),
prop.table(table(a1[,x], a1$group),2))
p <- chisq.test(table(a1[,x], a1$group))$p.value
sum <- cbind(x,'',n[,1],pct[,1],'','',n[,2],pct[,2],'','',n[,3],pct[,3],'',p)
}
sum
}
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
tabel1 <- cbind(row.names(table1), table1)
tabel1
tab2 <- function(x){
d <- a1[which(a1$group=='Case'),]
if(class(d[,x]) %in% c('numeric')){
n <- c(length(which(!is.na(d[,x]))),
tapply(d[,x], a1$group, function(y) length(which(!is.na(y)))))
m <- c(mean(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,mean, na.rm=T))
sd <- c(sd(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,sd, na.rm=T))
p <- t.test(d[,x]~d$enrolled)$p.value
sum <- c(x,n[1],m[1],sd[1],'',n[2],m[2],sd[2],'',n[3],m[3],sd[3],'',p)
}
if(class(d[,x]) %in% c('factor')){
n <- cbind(table(d[,x]),table(d[,x], d$enrolled))
pct <- cbind(prop.table(table(d[,x])),
prop.table(table(d[,x], d$enrolled),2))
p <- chisq.test(n[which(n[,1]>0),-1])$p.value
sum <- cbind(x,'',n[,1],pct[,1],'','',n[,2],pct[,2],'','',n[,3],pct[,3],'',p)
}
sum
}
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tab2 <- function(x){
d <- a1[which(a1$group=='Case'),]
if(class(d[,x]) %in% c('numeric')){
n <- c(length(which(!is.na(d[,x]))),
tapply(d[,x], d$group, function(y) length(which(!is.na(y)))))
m <- c(mean(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,mean, na.rm=T))
sd <- c(sd(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,sd, na.rm=T))
p <- t.test(d[,x]~d$enrolled)$p.value
sum <- c(x,n[1],m[1],sd[1],'',n[2],m[2],sd[2],'',n[3],m[3],sd[3],'',p)
}
if(class(d[,x]) %in% c('factor')){
n <- cbind(table(d[,x]),table(d[,x], d$enrolled))
pct <- cbind(prop.table(table(d[,x])),
prop.table(table(d[,x], d$enrolled),2))
p <- chisq.test(n[which(n[,1]>0),-1])$p.value
sum <- cbind(x,'',n[,1],pct[,1],'','',n[,2],pct[,2],'','',n[,3],pct[,3],'',p)
}
sum
}
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tabel2 <- cbind(row.names(table2), table2)
write.csv(table1, 'table 1.csv')
write.csv(table2, 'table 2.csv')
table(a1$tobacco_smoking_use)
a1$smok1 <- a1$smok
a1$smok1 <- a1$smok
a1$smok1[a1$smok1 %in% c('P','Q')] <- 'Quited/past/former'
a1$smok1[a1$smok1 %in% c('Y')] <- 'Current smoker'
a1$smok1[a1$smok1 %in% c('N')] <- 'Never smoker'
## merge all data by CVD_studyid
a1 <- Reduce(function(...) merge(...,by='cvd_studyid', all.x=T), datalist)
## set all NA for cvd outcomes as 0
a1[,124:133] <- lapply(a1[,124:133], function(x) {
x[is.na(x)] <- 0
x
})
# recode categorical variables
# age groups
a1$agegrp <- cut(a1$dxage, c(0, 40, 50, 60, 70, 80, 101), right=F,
labels = c('<40 yo','40-49','50-59','60-69','70-79','80+ yo'))
# race
a1$raceethn1 <- factor(a1$raceethn1,
labels=c("WHITE","BLACK","ASIAN","HISPANIC","PI","AI-AN"))
# postive nodes
a1$nodal <- factor(a1$nodal, labels = c('Positive','Negative'))
# tumor markers
a1[,c('er','pr','her2')] <- lapply(a1[,c('er','pr','her2')], function(x)
factor(x, levels = c(0,1,2,3,8,9),
labels = c('Not done','Positive','Negative',
'Borderline','Ordered, N/A',
'Unknown')))
# erpr status
a1$erpr <- factor(a1$erpr, labels = c('ER+/PR+','ER+/PR-','ER-/PR+','ER-/PR-',
'UNKNOWN'))
# more tumor markers and treatment received
a1[,c('tri_neg','chemo_yn','rad_yn','horm_yn')] <-
lapply(a1[,c('tri_neg','chemo_yn','rad_yn','horm_yn')], function(x)
factor(x, levels = c(0,1,9),
labels = c('No','Yes','Other')))
# AJCC stage
a1$ajcc_stage <- factor(a1$ajcc_stage,
labels = c('Stage I','Stage II', 'Stage III','Stage IV'))
# convert dxdate to date
a1$dxdate <- as.Date(a1$dxdate, origin = '1970-01-01')
# enrolled in Pathways
a1$enrolled <- factor(a1$enrolled, levels = c(0,1), labels=c('No','Yes'))
# create index year
a1$index_yr <- format(a1$index_date,"%Y")
a1$index_yr[a1$index_yr %in% c('2005','2006','2007')] <- '2005-2007'
a1$index_yr[a1$index_yr %in% c('2008','2009','2010')] <- '2008-2010'
a1$index_yr[a1$index_yr %in% c('2011','2012','2013')] <- '2011-2013'
a1$index_yr <- factor(a1$index_yr)
# create enrollment length
a1$enr_len <- as.numeric((a1$enr_end - a1$enr_start)/30)
# BMI category
a1$bmicat <- cut(a1$bmi, c(0,18.5,25,30,35,Inf),right=F,
labels = c('Underweight','Normal','Overweight','Obese I','Obese II+'))
# smoking status
a1$smok1 <- a1$smok
a1$smok1[a1$smok1 %in% c('P','Q')] <- 'Quited/past/former'
a1$smok1[a1$smok1 %in% c('Y')] <- 'Current smoker'
a1$smok1[a1$smok1 %in% c('N')] <- 'Never smoker'
a1$smok1 <- a1$tobacco_use
a1$smok1[a1$smok %in% c('P','Q')] <- 'Quited/past/former'
a1$smok1[a1$smok %in% c('Y')] <- 'Current smoker'
a1$smok1[a1$smok %in% c('N')] <- 'Never smoker'
a1$smok1 <- factor(a1$smok1, levels=c('Never smoker','Current smoker','Quited/past/former','U'))
# menopausal status
a1$menop <- factor(a1$bl_meno_status)
a1$menop[is.na(a1$menop) & a1$dxage>51] <- '1'
a1$menop[is.na(a1$menop) & a1$dxage<=51] <- '0'
# gravidity
a1$gravid <- cut(as.numeric(a1$ob_gravidity), c(0,1,2,3,Inf),right=F,
labels = c('0','1','2','3+'))
a1$parity <- cut(as.numeric(a1$ob_parity), c(0,1,2,3,Inf),right=F,
labels = c('0','1','2','3+'))
# diabetes
a1[,c("inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg")] <- lapply(a1[,c("inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg")],
function(x){
x[is.na(x)] <- 2
x <- factor(x, levels=c(1,0,2),labels = c('Yes','No','Unknown'))
x
})
# dyslipidemia
a1$dyslipidemia.x[is.na(a1$dyslipidemia.x)] <- 0
a1$dyslipidemia.x <- factor(a1$dyslipidemia.x,levels=c(1,0),
labels = c('Yes','No/Unknown'))
# household income
a1$hhincome1 <- rowSums(a1[,c(96:104)], na.rm = T)
a1$hhincome2 <- rowSums(a1[,c(105:107)], na.rm = T)
a1$hhincome3 <- rowSums(a1[,c(108:111)], na.rm = T)
# education
a1$edu1 <- rowSums(a1[,c(70:72)], na.rm = T)
a1$edu2 <- rowSums(a1[,c(73:74)], na.rm = T)
a1$edu3 <- a1$education6
a1$edu4 <- rowSums(a1[,c(76:77)], na.rm = T)
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tabel1 <- cbind(row.names(table1), table1)
tabel2 <- cbind(row.names(table2), table2)
write.csv(table1, 'table 1.csv')
write.csv(table2, 'table 2.csv')
tab2 <- function(x){
d <- a1[which(a1$group=='Case'),]
if(class(d[,x]) %in% c('numeric')){
n <- c(length(which(!is.na(d[,x]))),
tapply(d[,x], d$enrolled, function(y) length(which(!is.na(y)))))
m <- c(mean(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,mean, na.rm=T))
sd <- c(sd(d[,x], na.rm=T),
tapply(d[,x], d$enrolled,sd, na.rm=T))
p <- t.test(d[,x]~d$enrolled)$p.value
sum <- c(x,n[1],m[1],sd[1],'',n[2],m[2],sd[2],'',n[3],m[3],sd[3],'',p)
}
if(class(d[,x]) %in% c('factor')){
n <- cbind(table(d[,x]),table(d[,x], d$enrolled))
pct <- cbind(prop.table(table(d[,x])),
prop.table(table(d[,x], d$enrolled),2))
p <- chisq.test(n[which(n[,1]>0),-1])$p.value
sum <- cbind(x,'',n[,1],pct[,1],'','',n[,2],pct[,2],'','',n[,3],pct[,3],'',p)
}
sum
}
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tabel2 <- cbind(row.names(table2), table2)
write.csv(table2, 'table 2.csv')
summary(a1$menop)
table(cvd$CONDITION)
table(cvd$group)
cvd_grp
write.csv(cvd_grp,'cvd_grp.csv')
write.csv(cvd_cond,'cvd_cond.csv')
summary(a1$smok1)
a1$smok1[is.na(a1$smok)] <- 'Never smoker'
a1$smok1[is.na(a1$smok)] <- 'Unknown'
# smoking status
a1$smok1 <- a1$tobacco_use
a1$smok1[a1$smok %in% c('P','Q')] <- 'Quited/past/former'
a1$smok1[a1$smok %in% c('Y')] <- 'Current smoker'
a1$smok1[a1$smok %in% c('N')] <- 'Never smoker'
a1$smok1[a1$smok %in% c('U')] <- 'Unknown'
a1$smok1[is.na(a1$smok)] <- 'Unknown'
a1$smok1 <- factor(a1$smok1, levels=c('Never smoker','Current smoker','Quited/past/former','U'))
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
tabel1 <- cbind(row.names(table1), table1)
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tabel2 <- cbind(row.names(table2), table2)
write.csv(table1, 'table 1.csv')
write.csv(table2, 'table 2.csv')
# smoking status
a1$smok1 <- a1$tobacco_use
a1$smok1[a1$smok %in% c('P','Q')] <- 'Quited/past/former'
a1$smok1[a1$smok %in% c('Y')] <- 'Current smoker'
a1$smok1[a1$smok %in% c('N')] <- 'Never smoker'
a1$smok1[a1$smok %in% c('U')] <- 'Unknown'
a1$smok1[is.na(a1$smok)] <- 'Unknown'
a1$smok1 <- factor(a1$smok1, levels=c('Never smoker','Current smoker','Quited/past/former','Unknown'))
table1 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len','cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"
),tab1))
tabel1 <- cbind(row.names(table1), table1)
table2 <- do.call(rbind,lapply(c('dxage','agegrp','raceethn1','index_yr','enr_len',
"ajcc_stage", "nodal" ,"er", "pr", "erpr","her2","tri_neg",
"chemo_yn","rad_yn", "horm_yn",'cops2',
'bmi','bmicat','smok1','menop','gravid','parity',
"inpatient_flg","outpatient_flg","pharmacy_flg","a1c_flg",
"fgrg_flg","a1cfgrg_flg",'dyslipidemia.x',
"systolic" ,"diastolic","glu_f","hdl","hgba1c",
"ldl_clc_ns","tot_choles","trigl_ns",
'hhincome1','hhincome2',"hhincome3",'medhousincome',
'houspoverty', "edu1","edu2","edu3","edu4"),tab2))
tabel2 <- cbind(row.names(table2), table2)
write.csv(table1, 'table 1.csv')
write.csv(table2, 'table 2.csv')
summary(a1$menop)
